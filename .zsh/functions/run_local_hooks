#autoload

# NOTE!  This file not only gets used by zsh, but by
# .shared_env, and so has to work when source'd from
# any sh-compatible shell.  Well, any sensible sh.

# Example:
#
#   run_local_hooks .shared_env
#
# would check for files in this order:
#
#   1. $ZDOTDIR/.shared_env.local
#   2. $ZDOTDIR/.shared_env.HOSTNAME
#   3. $HOME/.shared_env.local
#   4. $HOME/.shared_env.HOSTNAME
#
# i.e. from least specific to most specific.

run_local_hooks () {
  for dir in ${zdotdirpath:-$HOME}; do
    if [ -n "$dir" ]; then
      for file in "$@"; do
        for suffix in local ${HOST%%.*}; do
          if [ -r "$dir/$file.$suffix" ]; then
            [ -n "$DEBUG_LOCAL_HOOKS" ] && echo . $dir/$file.$suffix
            . $dir/$file.$suffix
          fi
        done
      done
    fi
  done
}

run_local_hooks "$@"
