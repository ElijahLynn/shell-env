#autoload

if [[ $ZSH_VERSION_TYPE != 'new' ]]; then
  echo Need new zsh for scvs
  exit 1
fi

scvs () {
  if [[ -z "$1" ]]; then
    echo 'Usage: scvs <tag> [ options ]'
    return
  fi

  tag="$1"

  shift

  new_CVSROOT="$_CVSROOTS[$tag]"
  new_CVS_RSH="$_CVS_RSHS[$tag]"

  if [[ -z "$new_CVSROOT" ]]; then
    echo "Warning: CVSROOT for $tag undefined; not setting." >&2
  else
    export CVSROOT="$new_CVSROOT"
  fi

  if [[ -z "$new_CVS_RSH" ]]; then
    echo "Warning: CVS_RSH for $tag undefined; not setting." >&2
  else
    export CVS_RSH="$new_CVS_RSH"
  fi
}

typeset -Ag _CVSROOTS _CVS_RSHS
_CVSROOTS=(
           # Put your own CVSROOTs here
#          local             /usr/local/cvsroot
           local             $HOME/.CVSROOT
           mutt              :pserver:anonymous@ftp.guug.de:/home/roessler/cvs
### BEGIN PRIVATE
#           lb-plig            $SSH_STEPPING_STONE:/home/adams/.CVSROOT
           plig               plig.net:/home/adams/.CVSROOT
           thelonious         adam@thelonious.new.ox.ac.uk:/usr/local/cvsroot
           sourceforge_anon   :pserver:anonymous@cvs.sourceforge.net:/cvsroot/\$1
           sourceforge        :ext:adamspiers@cvs.sourceforge.net:/cvsroot/\$\{1:l\}

           zsh_sf_local_write adamspiers@cvs1:/cvsroot/zsh
           zsh_sf_local       :pserver:anonymous@cvs1:/cvsroot/zsh
           zsh_remote_write   adamspiers@cvs.zsh.sourceforge.net:/cvsroot/zsh
           zsh_remote         :pserver:anonymous@cvs.zsh.sourceforge.net:/cvsroot/zsh
### END PRIVATE
)

_CVS_RSHS=(
           # Put your own CVS_RSHs here, e.g.
#          foo.bar.com       ssh
#          foo.baz.com       rsh
### BEGIN PRIVATE
#           lb-plig           ~/bin/cvs-ssh
           plig              ssh
           thelonious        ssh
           sourceforge       ssh
           zsh_local_write   ssh
           zsh_local         ssh
           zsh_remote_write  ssh
           zsh_remote        ssh
### END PRIVATE
          )

scvs "$@"
